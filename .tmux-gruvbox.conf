set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-pain-control'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-open'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'soyuka/tmux-current-pane-hostname'
set -g @plugin 'christoomey/vim-tmux-navigator'
# set -g @plugin "arcticicestudio/nord-tmux"
# set -g @plugin 'egel/tmux-gruvbox'

set -g @nord_tmux_show_status_content "0"
set -g @nord_tmux_no_patched_font "1"

## COLORSCHEME: gruvbox dark
bg_h0="#1d2021"
bg_s0="#32302f"
bg0="#282828"
bg1="#3c3836"
bg2="#504945"
bg3="#665c54"
bg4="#7c6f64"
fg0="#a89984"
fg1="#bdae93"
fg2="#d5c4a1"
fg3="#ebdbb2"
fg4="#fbf1c7"
gray0="#928374"
gray1="#a89984"
red0="#c2441d"
red1="#fb4934"
green0="#98971a"
green1="#b8bb26"
yellow0="#d79921"
yellow1="#fabd2f"
blue0="#458588"
blue1="#83a598"
purple0="#b16286"
purple1="#d3869b"
aqua0="#689d6a"
aqua1="#8ec07c"
orange0="#d65d0e"
orange1="#fe8019"

# set TERM
set -g default-terminal "xterm-256color"

# change prefix to Ctrl-a instead of Ctrl-b
unbind C-b
set -g prefix C-a
bind C-a send-prefix

set-option -g status on

# default statusbar color
set-option -g status-style bg=$bg1,fg=$fg1

# default window title colors
set-window-option -g window-status-style bg=$yellow1,fg=$bg0

# default window with an activity alert
set-window-option -g window-status-activity-style bg=$red1,fg=$fg1

# active window title colors
set-window-option -g window-status-current-style bg=$blue0,fg=$bg0

# pane border
set-option -g pane-active-border-style fg=$yellow0
set-option -g pane-border-style fg=$bg1

# message infos
set-option -g message-style bg=$green0,fg=$bg0

# writing commands inactive
set-option -g message-command-style bg=$green1,fg=$bg0

# pane number display
set-option -g display-panes-active-colour $orange1
set-option -g display-panes-colour $bg1

# clock
set-window-option -g clock-mode-colour $blue0

# bell
set-window-option -g window-status-bell-style bg=$red1,fg=$fg1

## Theme settings mixed with colors (unfortunately, but there is no cleaner way)
# set-option -g status-justify "left"
# set-option -g status-left-style none
# set-option -g status-left-length "80"
# set-option -g status-right-style none
# set-option -g status-right-length "80"
# set-window-option -g window-status-separator ""

set-option -g status-left "#[fg=$bg0,bg=$gray1] S:#S "
set-option -g status-right "#{prefix_highlight} #[bg=$yellow1,fg=$bg0] #(~/.dotfiles/tmux/kubecontext.sh) #[bg=$orange0,fg=$fg4] #U #[fg=$fg4,bg=$red0] #H "
set-window-option -g window-status-format "#[fg=$fg0,bg=$bg1] #I:#W "
# set-window-option -g window-status-style fg=$fg0,bg=$bg1
set-window-option -g window-status-current-format "#[fg=$bg0,bg=$yellow1,bold] #I:#W "
# set-window-option -g window-status-current-style fg=$bg0,bg=$yellow1,bold
# set-window-option -g window-status-last-style fg=$fg4,bg=$bg1

# set windows and panes index to start from 1
set -g base-index 1
setw -g pane-base-index 1

# automaticaly rename and renumber windows and panes
setw -g automatic-rename
set -g renumber-windows

set -g set-titles on
set -g set-titles-string "#W @ #H"

# quickly open a new window
bind N new-window

# enter copy mode
bind Enter copy-mode

run -b 'tmux bind -t vi-copy v begin-selection 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi v send -X begin-selection 2> /dev/null || true'
run -b 'tmux bind -t vi-copy C-v rectangle-toggle 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi C-v send -X rectangle-toggle 2> /dev/null || true'
run -b 'tmux bind -t vi-copy y copy-selection 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi y send -X copy-selection-and-cancel 2> /dev/null || true'
run -b 'tmux bind -t vi-copy Escape cancel 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi Escape send -X cancel 2> /dev/null || true'
run -b 'tmux bind -t vi-copy H start-of-line 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi H send -X start-of-line 2> /dev/null || true'
run -b 'tmux bind -t vi-copy L end-of-line 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi L send -X end-of-line 2> /dev/null || true'

# automatically restore tmux session
set -g @continuum-restore 'on'

run -b '~/.dotfiles/tmux/plugins/tpm/tpm'
